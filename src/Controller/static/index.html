<h1>
    OMER'S ROOM LIGHTS
</h1>

<label>
    <input type="radio" id="LIGHTS_OFF" name="light_setting" value="LIGHTS_OFF">
    <i>Lights Off</i>
</label>
<br/>
<label>
    <input type="radio" id="SPOTIFY_LIGHTS_ON" name="light_setting" value="SPOTIFY_LIGHTS_ON">
    <i>Spotify Lights On</i>
</label>
<br/>
<label>
    <input type="radio" id="ANIMATION_LIGHTS_ON" name="light_setting" value="ANIMATION_LIGHTS_ON">
    <i>Spotify Lights On</i>
</label>

<div>
    <form id="uploadForm">
        <input type="file" id="fileInput" name="file" />
        <button type="button" onclick="upload_animation()">Upload</button>
    </form>    
</div>

<br/>

<script>
    function upload_animation(){
        const files = document.getElementById('fileInput')
        const file = fileInput.files[0]

        if(!file){
            alert('No file was selected, please select a file.')
            return;
        }
        
        const formData = new FormData()
        formData.append('file', file)
        
        fetch('/animation_files', {
            method: 'POST',
            body: formData
        }).then(response => {
            if(response.ok){
                alert('The file was uploaded')
            }
            else{
                alert('There was an error uploading the file, please try again')
            }
        }).catch(error => {
            alert('There was an error uploading the file.')
        })
    }
    function on_radio_click(){
        setting_to_send = null

        if(document.getElementById("LIGHTS_OFF").checked){

            document.getElementById("SPOTIFY_LIGHTS_ON").checked = false
            document.getElementById("ANIMATION_LIGHTS_ON").checked = false
            setting_to_send = "LIGHTS_OFF"    
        }
        else if(document.getElementById("SPOTIFY_LIGHTS_ON").checked){

            document.getElementById("LIGHTS_OFF").checked = false
            document.getElementById("ANIMATION_LIGHTS_ON").checked = false
            setting_to_send = "SPOTIFY_LIGHTS_ON"
        }
        else if(document.getElementById("ANIMATION_LIGHTS_ON").checked){

            document.getElementById("LIGHTS_OFF").checked = false
            document.getElementById("SPOTIFY_LIGHTS_ON").checked = false
            setting_to_send = "ANIMATION_LIGHTS_ON"
        }

        fetch("http://192.168.1.80:9090/light_setting", {
            method: "POST",
            headers: {
                "Content-Type": "application/json", // Set the appropriate content type for your data
            },
            body: JSON.stringify({ light_setting: setting_to_send }), // Convert your data to JSON if needed
        })
    }
    
    const buttons = document.getElementsByName("light_setting") 
    for(let i = 0; i < buttons.length; i++){
        buttons[i].addEventListener("click", on_radio_click)
    }
</script>